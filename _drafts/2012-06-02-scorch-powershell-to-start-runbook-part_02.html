---
layout: post
title: SCOrch – Powershell to start Runbook – Part 2
date: '2012-06-02T04:04:00.000-07:00'
author: Jon Mattivi
tags:
- guid
- PowerShell
- edm.guid
- Orchestrator
- Orchestrator Web Service
- scorch
- xml
- System Center Orchestrator 2012
- start runbook
- orchestrator.svc
modified_time: '2012-06-06T11:41:57.525-07:00'
blogger_id: tag:blogger.com,1999:blog-603465820850819373.post-7546125962108687937
blogger_orig_url: http://jmattivi.blogspot.com/2012/06/scorch-powershell-to-start-runbook-part_02.html
---

Here is an example to start a Runbook w/ parameters from Powershell.&nbsp;  It’s pretty much the same exact as a standard POST to start a Runbook,  but also includes the parameters in the properties struct.<br /><br />I’ve found that the free program Fiddler helps to find the guids and  struct needed to build the POST.&nbsp; You can also use the Orchestration  Console to drill down through to the Instance Summary and Activity  Details to find the guids for each parameter.<br /><br />This is the parameters struct that is added to the regular POST.<br /><br />Parameter1/Parameter2 are the names that you give the parameter.<br /><br />You need to specify the guid for each parameter.<br /><br />Value1/Value2 are the input values you’d like to specify for the Initialize Data activity.<br /><br />&lt;d:Parameters&gt;&amp;lt;Data&amp;gt;&amp;lt;Parameter&amp;gt;&amp;lt;Name&amp;gt;<span style="color: red;">Parameter1</span>&amp;lt;/Name&amp;gt;&amp;lt;ID&amp;gt;{<span style="color: red;">10000000-0000-0000-0000-000000000000</span>}&amp;lt;/ID&amp;gt;&amp;lt;Value&amp;gt;<span style="color: red;">Value1</span>&amp;lt;/Value&amp;gt;&amp;lt;/Parameter&amp;gt;&amp;lt;Parameter&amp;gt;&amp;lt;Name&amp;gt;<span style="color: red;">Parameter2</span>&amp;lt;/Name&amp;gt;&amp;lt;ID&amp;gt;{<span style="color: red;">20000000-0000-0000-0000-000000000000</span>}&amp;lt;/ID&amp;gt;&amp;lt;Value&amp;gt;<span style="color: red;">Value2</span>&amp;lt;/Value&amp;gt;&amp;lt;/Parameter&amp;gt;&amp;lt;/Data&amp;gt;&lt;/d:Parameters&gt;<br /><br />Here is the complete script to include the parameters in the POST to  start the Runbook.&nbsp; The highlighted fields would need updated to your  environment.<br /><br />&nbsp;##############################################################################<br /><br />$creds = Get-Credential("<span style="background-color: yellow; color: black;">domain\username</span>")<br /><br />$url = "<span style="background-color: yellow; color: black;">http://scorch.domain:81</span>/Orchestrator2012/Orchestrator.svc/Jobs/"<br /><br />$request = [System.Net.HttpWebRequest]::Create($url)<br /><br />$request.Credentials = $creds<br /><br />$request.Timeout = 60000<br /><br />$request.Accept = "application/atom+xml,application/xml"<br /><br />$request.Headers.Add("Accept-Charset", "UTF-8")<br /><br />$request.ContentType = "application/atom+xml"<br /><br />$request.Method = "POST"<br /><br />$requestBody = '&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?&gt;<br /><br />&lt;entry xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns="http://www.w3.org/2005/Atom"&gt;<br /><br />&lt;content type="application/xml"&gt;<br /><br />&lt;m:properties&gt;<br /><br />&lt;d:Parameters&gt;&amp;lt;Data&amp;gt;&amp;lt;Parameter&amp;gt;&amp;lt;Name&amp;gt;<span style="background-color: yellow; color: black;">Parameter1</span>&amp;lt;/Name&amp;gt;&amp;lt;ID&amp;gt;{<span style="background-color: yellow; color: black;">10000000-0000-0000-0000-000000000000</span>}&amp;lt;/ID&amp;gt;&amp;lt;Value&amp;gt;<span style="background-color: yellow; color: black;">Value1</span>&amp;lt;/Value&amp;gt;&amp;lt;/Parameter&amp;gt;&amp;lt;Parameter&amp;gt;&amp;lt;Name&amp;gt;<span style="background-color: yellow; color: black;">Parameter2</span>&amp;lt;/Name&amp;gt;&amp;lt;ID&amp;gt;{<span style="background-color: yellow; color: black;">20000000-0000-0000-0000-000000000000</span>}&amp;lt;/ID&amp;gt;&amp;lt;Value&amp;gt;<span style="background-color: yellow; color: black;">Value2</span>&amp;lt;/Value&amp;gt;&amp;lt;/Parameter&amp;gt;&amp;lt;/Data&amp;gt;&lt;/d:Parameters&gt;<br /><br />&lt;d:RunbookId type="Edm.Guid"&gt;<span style="background-color: yellow; color: black;">00000000-0000-0000-0000-000000000000</span>&lt;/d:RunbookId&gt;<br /><br />&lt;/m:properties&gt;<br /><br />&lt;/content&gt;<br /><br />&lt;/entry&gt;<br /><br />'<br /><br />$requeststream=new-object System.IO.StreamWriter $request.GetRequestStream()<br /><br />$requeststream.Write($requestBody)<br /><br />$requeststream.Flush()<br /><br />$requeststream.Close()<br /><br />$response=$request.GetResponse()<br /><br />$requestStream=$response.GetResponseStream()<br /><br />$readStream=new-object System.IO.StreamReader $requestStream<br /><br />$Output=$readStream.ReadToEnd()<br /><br />$readStream.Close()<br /><br />$response.Close()<br /><br />##############################################################################