---
layout: post
title: Lookup Where Variables Are Used in Runbooks and Activities
date: '2012-08-29T06:52:00.000-07:00'
author: Jon Mattivi
tags:
- SQL
- Standard Activities
- Variables
- activity
- Runbook Path
- Orchestrator 2012
- runbook
- System Center Orchestrator
- Search All Tables
- Database
- guid
- workflows
- database query
- Orchestrator
modified_time: '2012-08-31T08:52:53.202-07:00'
blogger_id: tag:blogger.com,1999:blog-603465820850819373.post-1034886281308014117
blogger_orig_url: http://jmattivi.blogspot.com/2012/08/lookup-where-variables-are-used-in.html
---

********Updated 8/31<br />&nbsp;Added code to exclude searching object/policy instance tables to reduce time the query runs.<br /><br />&nbsp;AND (@TableName != '[dbo].[OBJECTINSTANCEDATA]') AND (@TableName != '[dbo].[OBJECTINSTANCES]') AND (@TableName != '[dbo].[POLICYINSTANCES]')<br />********<br /><br />I've seen many people (including myself) submit enhancement requests for the product to include some sort of functionality of variable "mapping" to runbooks and activities.<br /><br />With over&nbsp; 2600 variables in my production database, it can be very time consuming to track down everywhere variables are used and to determine if they can be deleted if no longer used....<br /><br />Well....after some time of beating my head against a wall w/ SQL, I've finally gotten a working query to find the RunbookPath, RunbookName, ActivityName, and Table.Column (ActivityType.Field) where the variable is used in an Orchestrator instance!!!!<br /><br />For now, this will find where variables are used.&nbsp; I'd like to update the query to also be able to find counter and schedule instances as well.&nbsp; This should also be dynamic to find variables used in all Integration Packs (including OIT).<br /><br />I found a query to search across all tables and columns for a specific string on this site that got me in the right direction.<br /><a href="http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm">http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm</a><br /><br />From there I edited it to also include the other tables/fields to make the data useful in regards to SCOrch.<br /><br />You would need to edit the highlighted field below with the variable name you would like to search for.&nbsp; The only caveat is there cannot be any duplicate variable names.&nbsp; If there are duplicates, a few lines can be edited out.&nbsp; Then you could set @VarID equal to the guid of the variable you're attempting to lookup.<br /><br />You can use this query to lookup the guid&nbsp; by variable name if there are duplicates:<br /><br />Select VARIABLES.UniqueID<br />From VARIABLES<br />INNER JOIN OBJECTS ON OBJECTS.UniqueID = VARIABLES.UniqueID<br />Where OBJECTS.Name = '<span style="background-color: yellow;">MyVariableName'</span> and OBJECTS.Deleted != 1<br /><br /><br />Please let me know if you find any bugs or run into any errors w/ the query.&nbsp; Also, if anyone sees any room for improvement w/ the query (by no means am I an expert DBA :)).<br /><br />Here is an example of the output from the query.<br /><br /><img alt="" src="data:image/png;base64,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" /> <br /><br /><span style="background-color: orange;">****Depending on the size of the database, this query may take several minutes to run.</span><br /><br />Here is the query used to find variables throughout the database:<br /><br />--Originally Written by: Narayana Vyas Kondreddi<br />--Modified By: Jon Mattivi<br />--Purpose: Search all tables and columns in the Orchestrator database to find variable instances<br /><br />DECLARE @VarName nvarchar(100), @VarID nvarchar(100)<br />SET @VarName = '<span style="background-color: yellow;">MyVariableName</span>'<br /><br />SET @VarID = (Select VARIABLES.UniqueID<br />From VARIABLES<br />INNER JOIN OBJECTS ON OBJECTS.UniqueID = VARIABLES.UniqueID<br />Where OBJECTS.Name = @VarName and OBJECTS.Deleted != 1)<br /><br />&nbsp;&nbsp;&nbsp; <br />CREATE TABLE #Results (RunbookPath nvarchar(1000), RunbookName nvarchar(250), ActivityName nvarchar(250), [Table.Column] nvarchar(370))<br /><br />SET NOCOUNT ON<br /><br />DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)<br /><br />SET&nbsp; @TableName = ''<br />SET @SearchStr2 = QUOTENAME('%' + @VarID + '%','''')<br /><br />WHILE @TableName IS NOT NULL<br />&nbsp;&nbsp;&nbsp; <br />BEGIN<br />&nbsp;&nbsp;&nbsp; SET @ColumnName = ''<br />&nbsp;&nbsp;&nbsp; SET @TableName = <br />&nbsp;&nbsp;&nbsp; (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM&nbsp;&nbsp;&nbsp;&nbsp; INFORMATION_SCHEMA.TABLES<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TABLE_TYPE = 'BASE TABLE'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND&nbsp;&nbsp;&nbsp; QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) &gt; @TableName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND (TABLE_SCHEMA) = 'dbo'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND&nbsp;&nbsp;&nbsp; OBJECTPROPERTY(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OBJECT_ID(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ), 'IsMSShipped'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) = 0<br />&nbsp;&nbsp;&nbsp; )<br /><br />&nbsp;&nbsp;&nbsp; WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL) AND (@TableName != '[dbo].[OBJECTINSTANCEDATA]') AND (@TableName != '[dbo].[OBJECTINSTANCES]') AND (@TableName != '[dbo].[POLICYINSTANCES]') AND ((SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = PARSENAME(@TableName, 1) AND (COLUMN_NAME) = 'UniqueID' AND (DATA_TYPE) = 'uniqueidentifier' AND (TABLE_SCHEMA) = 'dbo') is not null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; BEGIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SET @ColumnName =<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT MIN(QUOTENAME(COLUMN_NAME))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM&nbsp;&nbsp;&nbsp;&nbsp; INFORMATION_SCHEMA.COLUMNS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TABLE_SCHEMA&nbsp;&nbsp;&nbsp; = PARSENAME(@TableName, 2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND&nbsp;&nbsp;&nbsp; TABLE_NAME&nbsp;&nbsp;&nbsp; = PARSENAME(@TableName, 1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND&nbsp;&nbsp;&nbsp; DATA_TYPE IN ('char', 'datetime', 'decimal', 'int', 'money', 'ntext', 'nvarchar', 'varbinary', 'varchar')<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND&nbsp;&nbsp;&nbsp; QUOTENAME(COLUMN_NAME) &gt; @ColumnName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF @ColumnName IS NOT NULL<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BEGIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INSERT INTO #Results<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EXEC<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'IF EXISTS (Select TOP 1 ' + @TableName + '.' + @ColumnName + 'From ' + @TableName + ' (NOLOCK) WHERE ' + @TableName + '.' + @ColumnName + ' LIKE ' + @SearchStr2 + ')' +<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'BEGIN ' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'SELECT Resources2.[Path], Policy.[Name], ActObj.[Name],''' + @TableName + '.' + @ColumnName + '''' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'FROM ' + @TableName + ' (NOLOCK) ' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'INNER JOIN [dbo].[OBJECTS] ActObj (NOLOCK) ON ' + @TableName + '.[UniqueID] = ActObj.[UniqueID]' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'INNER JOIN [dbo].[POLICIES] Policy (NOLOCK) ON ActObj.[ParentID] = Policy.[UniqueID]' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'INNER JOIN [Microsoft.SystemCenter.Orchestrator.Internal].[Resources] Resources2 (NOLOCK) ON Policy.[UniqueID] = Resources2.[UniqueId]' +<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 'WHERE ' + @TableName + '.' + @ColumnName + ' LIKE ' + @SearchStr2 + 'and ActObj.[Deleted] != 1 ' +<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'END'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; END<br />&nbsp;&nbsp;&nbsp; END&nbsp;&nbsp;&nbsp; <br />END<br /><br />SELECT * FROM #Results<br />Order By RunbookPath<br />&nbsp;&nbsp;&nbsp; <br />DROP TABLE #Results